<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

    <table id="tabla">
      <thead style="background: blue;">
        <tr>
          <th colspan="3">Alumno</th>
          <th>Res</th>
        </tr>

        <tr>
          <th colspan="2">Nombre</th>
          <th>Correo</th>
          <th>Pre</th>
        </tr>
      </thead>
      <tbody>

        <tr>
          <td>Johnny</td>
          <td>Garcia</td>
          <td>corrreoo</td>
          <td>no</td>
        </tr>
        <tr>
          <td>Edisson</td>
          <td>Garcia</td>
          <td>corrreoo</td>
          <td>no</td>
        </tr>
      </tbody>
    </table>

    <hr>

    <button type="button" name="button" onclick="exportar()">Exportar</button>

  </body>
</html>
<script lang="javascript" src="../Libs/FileSaver/FileSaver.min.js"></script>
<script lang="javascript" src="../Libs/xlsx/xlsx.full.min.js"></script>

<script type="text/javascript">
var wb = XLSX.utils.table_to_book(
  document.querySelector('#tabla'),
  {
    sheet: "EJEMPLOOOOOOO"
  }
);

var wbout = XLSX.write(
  wb, {
    bookType:'xlsx',
    bookSST:true,
    type: 'binary'
  }
);

function s2ab(a) {
  var buf = new ArrayBuffer(a.length);
  var view = new Uint8Array(buf);
  for(var i = 0; i < a.length; i++){
    view[i] = a.charCodeAt(i) & 0xFF;
  }
  return buf;
}

function exportar(){
  saveAs(new Blob(
    [s2ab(wbout)], {
      type: "application/octet-stream"
    }),
    'test.xlsx'
  );
}

</script>
